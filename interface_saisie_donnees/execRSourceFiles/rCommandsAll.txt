file<-read.csv("result.txt", header=T, sep="\t")
xt<-xtabs(freq ~ bookId+word, data=file)
cluster <- hclust(dist(xt))
pdf("plot.pdf", width=8, height=6)
par(family="mono")
plot(cluster)
dev.off()
distanceMatrix <- as.matrix(dist(xt,  upper=T, diag=T))
x<-row.names(distanceMatrix)
write.table(distanceMatrix, file="dataMatrix.txt", sep="\t", eol = "\n", col.names=x, row.names=FALSE)
write.table(xt, file="xt.txt", sep="\t", eol = "\n")
